<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>진격의 거인 달리기 게임</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #8B4513, #DEB887);
            min-height: 100vh;
            color: #2c1810;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 30px;
            color: #8B0000;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .selection-screen, .game-screen, .result-screen {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .titan-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .titan-card {
            border: 3px solid #ccc;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .titan-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .titan-card.selected {
            border-color: #8B0000;
            background: #ffe6e6;
        }

        .titan-emoji {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .titan-name {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .titan-ability {
            font-size: 0.9rem;
            color: #666;
        }

        .controls {
            text-align: center;
            margin-top: 20px;
        }

        button {
            background: #8B0000;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 1.1rem;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 10px;
            transition: background 0.3s ease;
        }

        button:hover {
            background: #a00000;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .race-track {
            margin: 20px 0;
            position: relative;
        }

        .track {
            height: 60px;
            background: linear-gradient(to right, #90EE90, #228B22);
            border: 2px solid #006400;
            border-radius: 30px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }

        .titan-runner {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2rem;
            transition: left 0.3s ease;
            z-index: 2;
        }

        .finish-line {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: repeating-linear-gradient(
                45deg,
                #000,
                #000 5px,
                #fff 5px,
                #fff 10px
            );
        }

        .runner-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .runner-name {
            font-weight: bold;
        }

        .runner-status {
            font-size: 0.9rem;
            color: #666;
        }

        .game-info {
            text-align: center;
            margin: 20px 0;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .hidden {
            display: none;
        }

        .result-list {
            list-style: none;
            padding: 0;
        }

        .result-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .rank {
            font-size: 1.5rem;
            font-weight: bold;
            margin-right: 20px;
            min-width: 40px;
        }

        .rank.first { color: #FFD700; }
        .rank.second { color: #C0C0C0; }
        .rank.third { color: #CD7F32; }

        .result-titan {
            font-size: 2rem;
            margin-right: 15px;
        }

        .result-name {
            font-size: 1.2rem;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🏃‍♂️ 진격의 거인 달리기 게임 🏃‍♂️</h1>

        <!-- 거인 선택 화면 -->
        <div id="selectionScreen" class="selection-screen">
            <h2 style="text-align: center; margin-bottom: 20px;">경주에 참여할 거인들을 선택하세요!</h2>
            <div class="titan-grid" id="titanGrid"></div>
            <div class="controls">
                <p id="selectionCount">선택된 거인: 0개 (최소 2개 이상 선택하세요)</p>
                <button id="startBtn" disabled onclick="startRace()">게임 시작!</button>
            </div>
        </div>

        <!-- 게임 화면 -->
        <div id="gameScreen" class="game-screen hidden">
            <div class="game-info">
                <span id="gameStatus">준비중...</span>
            </div>
            <div id="raceTrack" class="race-track"></div>
            <div class="controls">
                <button onclick="resetGame()">다시 선택하기</button>
            </div>
        </div>

        <!-- 결과 화면 -->
        <div id="resultScreen" class="result-screen hidden">
            <h2 style="text-align: center; margin-bottom: 20px;">🏆 경주 결과 🏆</h2>
            <ul id="resultList" class="result-list"></ul>
            <div class="controls">
                <button onclick="playAgain()">다시 경주하기</button>
                <button onclick="resetGame()">거인 다시 선택하기</button>
            </div>
        </div>
    </div>

    <script>
        const titans = [
            { name: "에렌 거인", emoji: "👹", ability: "공격형", speed: 0.8, attack: 0.3 },
            { name: "여성형 거인", emoji: "👩", ability: "민첩형", speed: 1.2, attack: 0.1 },
            { name: "갑옷 거인", emoji: "🛡️", ability: "방어형", speed: 0.6, attack: 0.2 },
            { name: "대형 거인", emoji: "🦣", ability: "파워형", speed: 0.4, attack: 0.4 },
            { name: "짐승 거인", emoji: "🦍", ability: "전략형", speed: 0.7, attack: 0.3 },
            { name: "턱 거인", emoji: "🦷", ability: "속도형", speed: 1.0, attack: 0.2 },
            { name: "전차 거인", emoji: "🚗", ability: "기동형", speed: 0.9, attack: 0.2 },
            { name: "망치 거인", emoji: "🔨", ability: "공성형", speed: 0.5, attack: 0.5 }
        ];

        let selectedTitans = [];
        let raceInProgress = false;
        let raceResults = [];

        function initGame() {
            renderTitanGrid();
            updateSelectionUI();
        }

        function renderTitanGrid() {
            const grid = document.getElementById('titanGrid');
            grid.innerHTML = '';
            
            titans.forEach((titan, index) => {
                const card = document.createElement('div');
                card.className = 'titan-card';
                card.onclick = () => toggleTitan(index);
                card.innerHTML = `
                    <div class="titan-emoji">${titan.emoji}</div>
                    <div class="titan-name">${titan.name}</div>
                    <div class="titan-ability">${titan.ability}</div>
                `;
                grid.appendChild(card);
            });
        }

        function toggleTitan(index) {
            if (selectedTitans.includes(index)) {
                selectedTitans = selectedTitans.filter(i => i !== index);
            } else {
                selectedTitans.push(index);
            }
            updateSelectionUI();
        }

        function updateSelectionUI() {
            const cards = document.querySelectorAll('.titan-card');
            cards.forEach((card, index) => {
                card.classList.toggle('selected', selectedTitans.includes(index));
            });

            const count = selectedTitans.length;
            document.getElementById('selectionCount').textContent = 
                `선택된 거인: ${count}개 ${count < 2 ? '(최소 2개 이상 선택하세요)' : ''}`;
            
            document.getElementById('startBtn').disabled = count < 2;
        }

        function startRace() {
            document.getElementById('selectionScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            
            setupRaceTrack();
            setTimeout(runRace, 1000);
        }

        function setupRaceTrack() {
            const track = document.getElementById('raceTrack');
            track.innerHTML = '';
            
            selectedTitans.forEach(index => {
                const titan = titans[index];
                const trackElement = document.createElement('div');
                trackElement.innerHTML = `
                    <div class="runner-info">
                        <span class="runner-name">${titan.name}</span>
                        <span class="runner-status" id="status-${index}">준비중</span>
                    </div>
                    <div class="track">
                        <div class="titan-runner" id="runner-${index}">${titan.emoji}</div>
                        <div class="finish-line"></div>
                    </div>
                `;
                track.appendChild(trackElement);
            });
        }

        function runRace() {
            raceInProgress = true;
            raceResults = [];
            document.getElementById('gameStatus').textContent = '경주 시작!';
            
            const runners = {};
            const positions = {};
            const stunned = {};
            
            selectedTitans.forEach(index => {
                runners[index] = document.getElementById(`runner-${index}`);
                positions[index] = 0;
                stunned[index] = 0;
            });

            const raceInterval = setInterval(() => {
                let raceFinished = false;
                
                selectedTitans.forEach(index => {
                    if (positions[index] >= 100) return;
                    
                    const titan = titans[index];
                    const statusElement = document.getElementById(`status-${index}`);
                    
                    // 기절 상태 처리
                    if (stunned[index] > 0) {
                        stunned[index]--;
                        statusElement.textContent = '기절중...';
                        return;
                    }
                    
                    // 랜덤 속도 + 기본 속도
                    const speed = (Math.random() * 2 + titan.speed) * 0.5;
                    positions[index] += speed;
                    
                    // 공격 확률
                    if (Math.random() < titan.attack * 0.1) {
                        const targets = selectedTitans.filter(t => t !== index && positions[t] < 100);
                        if (targets.length > 0) {
                            const target = targets[Math.floor(Math.random() * targets.length)];
                            stunned[target] = Math.floor(Math.random() * 3) + 1;
                            statusElement.textContent = '공격!';
                            document.getElementById(`status-${target}`).textContent = '공격받음!';
                        }
                    } else {
                        statusElement.textContent = '달리는중';
                    }
                    
                    // 위치 업데이트
                    const percentage = Math.min(positions[index], 100);
                    runners[index].style.left = `${percentage - 5}%`;
                    
                    // 결승선 도달 체크
                    if (positions[index] >= 100 && !raceResults.find(r => r.index === index)) {
                        raceResults.push({ 
                            index: index, 
                            titan: titan, 
                            rank: raceResults.length + 1 
                        });
                        statusElement.textContent = '완주!';
                    }
                });
                
                // 모든 거인이 완주했는지 체크
                if (raceResults.length === selectedTitans.length) {
                    clearInterval(raceInterval);
                    setTimeout(showResults, 2000);
                }
            }, 100);
        }

        function showResults() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');
            
            const resultList = document.getElementById('resultList');
            resultList.innerHTML = '';
            
            raceResults.forEach((result, index) => {
                const li = document.createElement('li');
                li.className = 'result-item';
                
                let rankClass = '';
                let rankText = `${result.rank}위`;
                if (result.rank === 1) {
                    rankClass = 'first';
                    rankText = '🥇 1위';
                } else if (result.rank === 2) {
                    rankClass = 'second';
                    rankText = '🥈 2위';
                } else if (result.rank === 3) {
                    rankClass = 'third';
                    rankText = '🥉 3위';
                }
                
                li.innerHTML = `
                    <span class="rank ${rankClass}">${rankText}</span>
                    <span class="result-titan">${result.titan.emoji}</span>
                    <span class="result-name">${result.titan.name}</span>
                `;
                resultList.appendChild(li);
            });
        }

        function playAgain() {
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            setupRaceTrack();
            setTimeout(runRace, 1000);
        }

        function resetGame() {
            selectedTitans = [];
            raceResults = [];
            raceInProgress = false;
            
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('selectionScreen').classList.remove('hidden');
            
            updateSelectionUI();
        }

        // 게임 초기화
        initGame();
    </script>
</body>
</html>
