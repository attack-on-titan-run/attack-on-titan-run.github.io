<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>진격의 거인 달리기 게임</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial Black', 'Arial', sans-serif;
            background: linear-gradient(135deg, #2C1810, #4A3728, #8B4513);
            background-attachment: fixed;
            min-height: 100vh;
            color: #F5DEB3;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(139, 69, 19, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139, 0, 0, 0.2) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            text-align: center;
            font-size: 3rem;
            margin-bottom: 30px;
            color: #DC143C;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
            font-weight: bold;
            letter-spacing: 2px;
            background: linear-gradient(45deg, #DC143C, #8B0000);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .selection-screen, .game-screen, .result-screen {
            background: linear-gradient(145deg, rgba(44, 24, 16, 0.95), rgba(74, 55, 40, 0.95));
            border: 3px solid #8B4513;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 
                0 15px 35px rgba(0,0,0,0.5),
                inset 0 2px 10px rgba(245, 222, 179, 0.1);
            backdrop-filter: blur(10px);
        }

        .titan-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-bottom: 10px;
        }

        .titan-card {
            border: 3px solid #8B4513;
            border-radius: 15px;
            padding: 5px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s ease;
            background: linear-gradient(145deg, rgba(74, 55, 40, 0.8), rgba(44, 24, 16, 0.9));
            color: #F5DEB3;
            position: relative;
            overflow: hidden;
        }

        .titan-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(220, 20, 60, 0.1), transparent);
            transition: all 0.6s ease;
            opacity: 0;
        }

        .titan-card:hover::before {
            opacity: 1;
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%); }
            100% { transform: translateX(100%) translateY(100%); }
        }

        .titan-card:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 
                0 15px 25px rgba(0,0,0,0.4),
                0 0 20px rgba(220, 20, 60, 0.3);
            border-color: #DC143C;
        }

        .titan-card.selected {
            border-color: #DC143C;
            background: linear-gradient(145deg, rgba(220, 20, 60, 0.2), rgba(139, 0, 0, 0.3));
            box-shadow: 
                0 10px 20px rgba(0,0,0,0.3),
                0 0 30px rgba(220, 20, 60, 0.5),
                inset 0 2px 10px rgba(220, 20, 60, 0.2);
        }

        .titan-emoji {
            font-size: 3rem;
            margin-bottom: 5px;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 5px auto;
        }

        .titan-emoji img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .titan-name {
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 1px;
            color: #F5DEB3;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .titan-ability {
            font-size: 1rem;
            color: #CD853F;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.6);
        }

        .controls {
            text-align: center;
            margin-top: 20px;
        }

        button {
            background: linear-gradient(145deg, #DC143C, #8B0000);
            color: #F5DEB3;
            border: 2px solid #8B4513;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s ease;
        }

        button:hover::before {
            left: 100%;
        }

        button:hover {
            background: linear-gradient(145deg, #FF1744, #DC143C);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
            border-color: #DC143C;
        }

        button:disabled {
            background: linear-gradient(145deg, #555, #333);
            color: #888;
            cursor: not-allowed;
            border-color: #444;
            box-shadow: none;
            transform: none;
        }

        button:disabled::before {
            display: none;
        }

        .race-track {
            margin: 10px 0;
            position: relative;
        }

        .track {
            height: 70px;
            background: linear-gradient(to right, 
                #654321 0%, 
                #8B4513 20%, 
                #A0522D 50%, 
                #8B4513 80%, 
                #654321 100%);
            position: relative;
        }

        .track::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                90deg,
                transparent 0px,
                rgba(245, 222, 179, 0.1) 50px,
                transparent 100px
            );
        }

        .titan-runner {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2.5rem;
            transition: left 0.3s ease;
            z-index: 2;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.8));
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .titan-runner img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: all 0.3s ease;
        }

        /* 공격 효과 */
        .attacking {
            animation: attackFlash 0.6s ease-in-out;
            transform: translateY(-50%) scale(1.2);
            filter: drop-shadow(0 0 15px #FF4444) brightness(1.3);
        }

        @keyframes attackFlash {
            0% { filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.8)); }
            50% { filter: drop-shadow(0 0 20px #FF4444) brightness(1.5); }
            100% { filter: drop-shadow(0 0 15px #FF4444) brightness(1.3); }
        }

        /* 기절 효과 */
        .stunned {
            animation: stunEffect 1s ease-in-out infinite;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.8)) grayscale(0.7) brightness(0.6);
        }

        @keyframes stunEffect {
            0%, 100% { transform: translateY(-50%) rotate(-5deg); }
            50% { transform: translateY(-50%) rotate(5deg); }
        }

        /* 달리는 효과 */
        .running {
            animation: runBounce 0.4s ease-in-out infinite alternate;
        }

        @keyframes runBounce {
            0% { transform: translateY(-50%) scale(1); }
            100% { transform: translateY(-50%) scale(1.05); }
        }

        /* 완주 효과 */
        .finished {
            animation: finishCelebration 1s ease-in-out;
            filter: drop-shadow(0 0 20px #FFD700) brightness(1.4);
        }

        @keyframes finishCelebration {
            0%, 100% { transform: translateY(-50%) scale(1); }
            25% { transform: translateY(-50%) scale(1.3) rotate(-10deg); }
            50% { transform: translateY(-50%) scale(1.2) rotate(10deg); }
            75% { transform: translateY(-50%) scale(1.3) rotate(-5deg); }
        }

        /* 공격 받은 효과 */
        .hit {
            animation: hitShake 0.5s ease-in-out;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.8)) brightness(1.2) hue-rotate(320deg);
        }

        @keyframes hitShake {
            0%, 100% { transform: translateY(-50%) translateX(0); }
            25% { transform: translateY(-50%) translateX(-8px); }
            75% { transform: translateY(-50%) translateX(8px); }
        }

        /* 효과 파티클 */
        .effect-particle {
            position: absolute;
            pointer-events: none;
            z-index: 3;
            font-size: 1.5rem;
            animation: particleFloat 1s ease-out forwards;
        }

        @keyframes particleFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-30px) scale(1.5);
            }
        }

        .finish-line {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 5px;
            background: repeating-linear-gradient(
                45deg,
                #F5DEB3,
                #F5DEB3 8px,
                #DC143C 8px,
                #DC143C 16px
            );
            box-shadow: -2px 0 5px rgba(0,0,0,0.5);
        }

        .runner-info {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-bottom: 0px;
        }

        .runner-name {
            font-weight: bold;
            color: #F5DEB3;
            font-size: 1.1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .runner-status {
            font-size: 0.9rem;
            color: #CD853F;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            opacity: 0.7;
        }

        .game-info {
            text-align: center;
            margin: 20px 0;
            font-size: 1.4rem;
            font-weight: bold;
            color: #DC143C;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            background: linear-gradient(145deg, rgba(220, 20, 60, 0.1), rgba(139, 0, 0, 0.1));
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #8B4513;
        }

        .hidden {
            display: none;
        }

        .result-list {
            list-style: none;
            padding: 0;
        }

        .result-item {
            display: flex;
            align-items: center;
            justify-content: center; 
            padding: 20px;
            margin: 15px 0;
            background: linear-gradient(145deg, rgba(74, 55, 40, 0.6), rgba(44, 24, 16, 0.8));
            border: 2px solid #8B4513;
            border-radius: 15px;
            box-shadow: 
                0 5px 15px rgba(0,0,0,0.3),
                inset 0 2px 5px rgba(245, 222, 179, 0.1);
        }

        .rank {
            font-size: 1.5rem;
            font-weight: bold;
            margin-right: 20px;
            min-width: 40px;
        }

        .rank.first { color: #FFD700; }
        .rank.second { color: #C0C0C0; }
        .rank.third { color: #CD7F32; }

        .result-titan {
            font-size: 2rem;
            margin-right: 15px;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .result-titan img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 50%;
            border: 2px solid #8B4513;
            background: rgba(245, 222, 179, 0.1);
        }

        .result-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #F5DEB3;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
    </style>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5265241179562366"
     crossorigin="anonymous"></script>
</head>
<body>
    <div class="container">
        <h1>🏃‍♂️ 진격의 거인 달리기 게임 🏃‍♂️</h1>

        <!-- 거인 선택 화면 -->
        <div id="selectionScreen" class="selection-screen">
            <h2 style="text-align: center; margin-bottom: 20px; color: #F5DEB3; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">경주에 참여할 거인들을 선택하세요!</h2>
            <div class="titan-grid" id="titanGrid"></div>
            <div class="controls">
                <p id="selectionCount" style="color: #F5DEB3; font-size: 1.1rem; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">선택된 거인: 0개 (최소 2개 이상 선택하세요)</p>
                <button id="startBtn" disabled onclick="startRace()">게임 시작!</button>
            </div>
        </div>

        <!-- 게임 화면 -->
        <div id="gameScreen" class="game-screen hidden">
            <div class="game-info">
                <span id="gameStatus">준비중...</span>
            </div>
            <div id="raceTrack" class="race-track"></div>
            <div class="controls">
            </div>
        </div>

        <!-- 결과 화면 -->
        <div id="resultScreen" class="result-screen hidden">
            <h2 style="text-align: center; margin-bottom: 20px; color: #F5DEB3; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">🏆 경주 결과 🏆</h2>
            <ul id="resultList" class="result-list"></ul>
            <div class="controls">
                <button onclick="playAgain()">다시 경주하기</button>
                <button onclick="resetGame()">거인 다시 선택하기</button>
            </div>
        </div>
    </div>

    <script>
        const titans = [
            { 
                name: "시조의 거인", 
                cardImage: "images/founding_titan_card.png",
                runnerImage: "images/founding_titan_runner.png"
            },
            { 
                name: "진격의 거인", 
                cardImage: "images/attack_titan_card.png",
                runnerImage: "images/attack_titan_runner.png"
            },
            { 
                name: "초대형 거인", 
                cardImage: "images/colossal_titan_card.png",
                runnerImage: "images/colossal_titan_runner.png"
            },
            { 
                name: "갑옷 거인", 
                cardImage: "images/armored_titan_card.png",
                runnerImage: "images/armored_titan_runner.png"
            },
            { 
                name: "여성형 거인", 
                cardImage: "images/female_titan_card.png",
                runnerImage: "images/female_titan_runner.png"
            },
            { 
                name: "짐승 거인", 
                cardImage: "images/beast_titan_card.png",
                runnerImage: "images/beast_titan_runner.png"
            },
            { 
                name: "턱 거인", 
                cardImage: "images/jaw_titan_card.png",
                runnerImage: "images/jaw_titan_runner.png"
            },
            { 
                name: "전차 거인", 
                cardImage: "images/cart_titan_card.png",
                runnerImage: "images/cart_titan_runner.png"
            },
            { 
                name: "워해머 거인", 
                cardImage: "images/warhammer_titan_card.png",
                runnerImage: "images/warhammer_titan_runner.png"
            }
        ];

        let selectedTitans = [];
        let raceInProgress = false;
        let raceResults = [];

        function getDefaultEmoji(titanName) {
            const emojiMap = {
                "시조의 거인": "👑",
                "진격의 거인": "⚔️", 
                "초대형 거인": "🏗️",
                "갑옷 거인": "🛡️",
                "여성형 거인": "👩",
                "짐승 거인": "🦍",
                "턱 거인": "🦷",
                "전차 거인": "🚗",
                "워해머 거인": "🔨"
            };
            return emojiMap[titanName] || "🔸";
        }

        function initGame() {
            renderTitanGrid();
            updateSelectionUI();
        }

        function renderTitanGrid() {
            const grid = document.getElementById('titanGrid');
            grid.innerHTML = '';
            
            titans.forEach((titan, index) => {
                const card = document.createElement('div');
                card.className = 'titan-card';
                card.onclick = () => toggleTitan(index);
                
                const isImagePath = titan.cardImage.includes('/');
                const cardContent = isImagePath ? 
                    `<img src="${titan.cardImage}" alt="${titan.name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                     <div style="display:none; font-size:4rem;">${getDefaultEmoji(titan.name)}</div>` 
                    : titan.cardImage;
                
                card.innerHTML = `
                    <div class="titan-emoji">${cardContent}</div>
                    <div class="titan-name">${titan.name}</div>
                `;
                grid.appendChild(card);
            });
        }

        function toggleTitan(index) {
            if (selectedTitans.includes(index)) {
                selectedTitans = selectedTitans.filter(i => i !== index);
            } else {
                selectedTitans.push(index);
            }
            updateSelectionUI();
        }

        function updateSelectionUI() {
            const cards = document.querySelectorAll('.titan-card');
            cards.forEach((card, index) => {
                card.classList.toggle('selected', selectedTitans.includes(index));
            });

            const count = selectedTitans.length;
            document.getElementById('selectionCount').textContent = 
                `선택된 거인: ${count}개 ${count < 2 ? '(최소 2개 이상 선택하세요)' : ''}`;
            
            document.getElementById('startBtn').disabled = count < 2;
        }

        function startRace() {
            document.getElementById('selectionScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            
            setupRaceTrack();
            setTimeout(runRace, 1000);
        }

        function createEffect(runner, effectType) {
            const particle = document.createElement('div');
            particle.className = 'effect-particle';
            
            const effects = {
                attack: '💥',
                hit: '💫',
                stun: '😵',
                finish: '🎉'
            };
            
            particle.textContent = effects[effectType] || '✨';
            particle.style.left = runner.style.left;
            particle.style.top = '20%';
            
            runner.parentElement.appendChild(particle);
            
            setTimeout(() => {
                if (particle.parentElement) {
                    particle.parentElement.removeChild(particle);
                }
            }, 1000);
        }

        function setRunnerState(index, state) {
            const runner = document.getElementById(`runner-${index}`);
            const statusElement = document.getElementById(`status-${index}`);
            
            if (!runner) return;
            
            // 모든 상태 클래스 제거
            runner.classList.remove('attacking', 'stunned', 'running', 'finished', 'hit');
            
            switch(state) {
                case 'attack':
                    runner.classList.add('attacking');
                    statusElement.textContent = '';
                    createEffect(runner, 'attack');
                    break;
                case 'stunned':
                    runner.classList.add('stunned');
                    statusElement.textContent = '';
                    createEffect(runner, 'stun');
                    break;
                case 'hit':
                    runner.classList.add('hit');
                    statusElement.textContent = '';
                    createEffect(runner, 'hit');
                    break;
                case 'running':
                    runner.classList.add('running');
                    statusElement.textContent = '';
                    break;
                case 'finished':
                    runner.classList.add('finished');
                    statusElement.textContent = '';
                    createEffect(runner, 'finish');
                    break;
                default:
                    statusElement.textContent = '';
            }
        }

        function setupRaceTrack() {
            const track = document.getElementById('raceTrack');
            track.innerHTML = '';
            
            selectedTitans.forEach(index => {
                const titan = titans[index];
                const trackElement = document.createElement('div');
                
                const isImagePath = titan.runnerImage.includes('/');
                const runnerContent = isImagePath ? 
                    `<img src="${titan.runnerImage}" alt="${titan.name}" onerror="this.outerHTML='${getDefaultEmoji(titan.name)}';">` 
                    : titan.runnerImage;
                
                trackElement.innerHTML = `
                    <div class="runner-status" id="status-${index}"></div>
                    <div class="track">
                        <div class="titan-runner" id="runner-${index}">${runnerContent}</div>
                        <div class="finish-line"></div>
                    </div>
                `;
                track.appendChild(trackElement);
            });
        }

        function runRace() {
            raceInProgress = true;
            raceResults = [];
            document.getElementById('gameStatus').textContent = '경주 시작!';
            
            const runners = {};
            const positions = {};
            const stunned = {};
            
            selectedTitans.forEach(index => {
                runners[index] = document.getElementById(`runner-${index}`);
                positions[index] = 0;
                stunned[index] = 0;
            });

            const raceInterval = setInterval(() => {
                let raceFinished = false;
                
                selectedTitans.forEach(index => {
                    if (positions[index] >= 100) return;
                    
                    const titan = titans[index];
                    
                    // 기절 상태 처리
                    if (stunned[index] > 0) {
                        stunned[index]--;
                        setRunnerState(index, 'stunned');
                        return;
                    }
                    
                    // 완전 랜덤 속도 (0.0 ~ 2.0 범위)
                    const speed = Math.random() * 2.0;
                    positions[index] += speed;
                    
                    // 랜덤 공격 확률 (5% 확률로 공격)
                    if (Math.random() < 0.05) {
                        const targets = selectedTitans.filter(t => t !== index && positions[t] < 100);
                        if (targets.length > 0) {
                            const target = targets[Math.floor(Math.random() * targets.length)];
                            stunned[target] = Math.floor(Math.random() * 2) + 1;
                            
                            // 공격자와 피격자 효과 적용
                            setRunnerState(index, 'attack');
                            setTimeout(() => setRunnerState(target, 'hit'), 200);
                            
                            // 1초 후 공격 효과 제거
                            setTimeout(() => {
                                if (stunned[index] === 0 && positions[index] < 100) {
                                    setRunnerState(index, 'running');
                                }
                            }, 1000);
                        }
                    } else {
                        setRunnerState(index, 'running');
                    }
                    
                    // 위치 업데이트
                    const percentage = Math.min(positions[index], 100);
                    runners[index].style.left = `${percentage - 5}%`;
                    
                    // 결승선 도달 체크
                    if (positions[index] >= 100 && !raceResults.find(r => r.index === index)) {
                        raceResults.push({ 
                            index: index, 
                            titan: titan, 
                            rank: raceResults.length + 1 
                        });
                        setRunnerState(index, 'finished');
                    }
                });
                
                // 모든 거인이 완주했는지 체크
                if (raceResults.length === selectedTitans.length) {
                    clearInterval(raceInterval);
                    setTimeout(showResults, 1000);
                }
            }, 100);
        }

        function showResults() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');
            
            const resultList = document.getElementById('resultList');
            resultList.innerHTML = '';
            
            raceResults.forEach((result, index) => {
                const li = document.createElement('li');
                li.className = 'result-item';
                
                const isImagePath = result.titan.runnerImage.includes('/');
                const titanDisplay = isImagePath ? 
                    `<img src="${result.titan.runnerImage}" alt="${result.titan.name}" onerror="this.outerHTML='${getDefaultEmoji(result.titan.name)}';">` 
                    : result.titan.runnerImage;
                
                let rankClass = '';
                let rankText = `${result.rank}위`;
                if (result.rank === 1) {
                    rankClass = 'first';
                    rankText = '🥇 1위';
                } else if (result.rank === 2) {
                    rankClass = 'second';
                    rankText = '🥈 2위';
                } else if (result.rank === 3) {
                    rankClass = 'third';
                    rankText = '🥉 3위';
                }
                
                li.innerHTML = `
                    <span class="rank ${rankClass}">${rankText}</span>
                    <span class="result-titan">${titanDisplay}</span>
                    <span class="result-name">${result.titan.name}</span>
                `;
                resultList.appendChild(li);
            });
        }

        function playAgain() {
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            setupRaceTrack();
            setTimeout(runRace, 1000);
        }

        function resetGame() {
            selectedTitans = [];
            raceResults = [];
            raceInProgress = false;
            
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('selectionScreen').classList.remove('hidden');
            
            updateSelectionUI();
        }

        // 게임 초기화
        initGame();
    </script>
</body>
</html>
